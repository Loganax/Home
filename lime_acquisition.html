<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acquisizione RAM con LiME - NOSC TTP</title>
    <link rel="stylesheet" href="style.css">
</head>
<!-- HTML - Da inserire prima del closing </body> in ogni pagina -->
<div class="print-buttons">
    <button onclick="printCurrentPage()" class="btn-print">
        <span class="btn-icon">ðŸ“„</span> Stampa Pagina
    </button>
    <button onclick="printManual()" class="btn-print btn-manual">
        <span class="btn-icon">ðŸ“š</span> Stampa Manuale
    </button>
</div>

<script>
// Funzione per stampare la pagina corrente (converte in PDF)
function printCurrentPage() {
    window.print();
}

// Funzione per stampare l'intero manuale
function printManual() {
    // Array con tutte le pagine del manuale in ordine
    const pages = [
        'index.html',
        'nosc_index.html',
        'lime_acquisition.html'
        // Aggiungi qui altre pagine future
    ];
    
    // Crea una nuova finestra
    const printWindow = window.open('', '_blank');
    
    // Inizializza il documento
    printWindow.document.write(`
        <!DOCTYPE html>
        <html lang="it">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>NOSC - Manuale Completo</title>
            <link rel="stylesheet" href="style.css">
            <style>
                @media print {
                    .print-buttons { display: none !important; }
                }
            </style>
        </head>
        <body>
    `);
    
    // Variabile per tracciare le pagine caricate
    let loadedPages = 0;
    
    // Carica e aggiungi ogni pagina
    pages.forEach((page, index) => {
        fetch(page)
            .then(response => {
                if (!response.ok) {
                    throw new Error('HTTP error! status: ' + response.status);
                }
                return response.text();
            })
            .then(html => {
                // Estrai il contenuto della pagina
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                // Cerca sia .page che .cover-page
                let pageContent = doc.querySelector('.page') || doc.querySelector('.cover-page');
                
                if (pageContent) {
                    // Rimuovi i bottoni di stampa se presenti
                    const buttons = pageContent.querySelector('.print-buttons');
                    if (buttons) buttons.remove();
                    
                    printWindow.document.body.innerHTML += pageContent.outerHTML;
                }
                
                loadedPages++;
                
                // Quando tutte le pagine sono caricate, stampa
                if (loadedPages === pages.length) {
                    printWindow.document.write('</body></html>');
                    printWindow.document.close();
                    
                    // Attendi che le risorse siano caricate prima di stampare
                    setTimeout(function() {
                        printWindow.print();
                    }, 1000);
                }
            })
            .catch(error => {
                console.error('Errore nel caricamento di ' + page + ':', error);
                alert('Impossibile caricare ' + page + '. Assicurati che i file siano serviti da un web server locale (es: python -m http.server o Live Server in VSCode)');
                loadedPages++;
                
                // Se tutte le pagine sono state tentate (anche con errori)
                if (loadedPages === pages.length) {
                    printWindow.document.write('</body></html>');
                    printWindow.document.close();
                }
            });
    });
}
</script>
<body>
    <div class="page">
        <div class="page-header">
            <h1>Acquisizione Forense di Memoria RAM con LiME</h1>
            <div class="breadcrumb">NOSC - TTP | Informatica Forense | Linux</div>
        </div>
        
        <div class="page-content">
            <h2>Requisiti Preliminari</h2>
            <ul>
                <li><strong>Sistema target:</strong> Sistema Linux da analizzare</li>
                <li><strong>Accesso root:</strong> Privilegi amministrativi sul sistema</li>
                <li><strong>Kernel headers:</strong> Installati e corrispondenti alla versione del kernel</li>
                <li><strong>Tool necessari:</strong> git, make, gcc</li>
            </ul>

            <h2>Procedura di Acquisizione</h2>

            <h3>1. Preparazione del Sistema</h3>
            <ul>
                <li>Verificare la versione del kernel in uso:
                    <pre><code>uname -r</code></pre>
                </li>
                <li>Installare i kernel headers corrispondenti:
                    <pre><code>apt-get install linux-headers-$(uname -r)  # Debian/Ubuntu
yum install kernel-devel-$(uname -r)      # RHEL/CentOS</code></pre>
                </li>
                <li>Installare le dipendenze di compilazione:
                    <pre><code>apt-get install build-essential git  # Debian/Ubuntu
yum groupinstall "Development Tools" git # RHEL/CentOS</code></pre>
                </li>
            </ul>

            <h3>2. Download e Compilazione di LiME</h3>
            <ul>
                <li>Clonare il repository ufficiale di LiME:
                    <pre><code>git clone https://github.com/504ensicsLabs/LiME.git
cd LiME/src</code></pre>
                </li>
                <li>Compilare il modulo kernel:
                    <pre><code>make</code></pre>
                </li>
                <li>Verificare la creazione del file <code>lime-*.ko</code></li>
            </ul>

            <h3>3. Acquisizione della Memoria</h3>
            <ul>
                <li>Creare una directory per l'output:
                    <pre><code>mkdir /tmp/forensics</code></pre>
                </li>
                <li>Caricare il modulo LiME specificando il path e il formato:
                    <pre><code>insmod lime-*.ko "path=/tmp/forensics/ram.lime format=lime"</code></pre>
                </li>
                <li>Attendere il completamento dell'acquisizione (nessun output = successo)</li>
            </ul>

            <h3>4. Verifica e Conservazione</h3>
            <ul>
                <li>Verificare la creazione del file dump:
                    <pre><code>ls -lh /tmp/forensics/ram.lime</code></pre>
                </li>
                <li>Calcolare l'hash del dump per chain of custody:
                    <pre><code>sha256sum /tmp/forensics/ram.lime > ram.lime.sha256</code></pre>
                </li>
                <li>Trasferire il dump su storage forense:
                    <pre><code>dd if=/tmp/forensics/ram.lime | ssh user@forensic-server "cat > /evidence/case-X/ram.lime"</code></pre>
                </li>
            </ul>

            <div class="note">
                <strong>NOTA IMPORTANTE:</strong> L'acquisizione della RAM Ã¨ un'operazione volatile. Eseguire l'acquisizione il prima possibile dopo l'incident response. Il caricamento del modulo LiME modifica minimamente lo stato della memoria, ma Ã¨ inevitabile. Documentare sempre timestamp e hash per la catena di custodia.
            </div>

            <h2>Formati di Output</h2>
            <ul>
                <li><strong>lime:</strong> Formato nativo LiME con metadati (raccomandato)</li>
                <li><strong>raw:</strong> Dump grezzo della memoria fisica</li>
                <li><strong>padded:</strong> Dump con padding agli indirizzi corretti</li>
            </ul>

        </div>
        
        <div class="page-footer">
            NOSC - Manuale di Informatica Forense | Acquisizione RAM con LiME | Pagina 1
        </div>
    </div>
</body>
</html>